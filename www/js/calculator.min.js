class Calc{#a={b:!0};#c=null;#d=null;#e='en';#f=null;#g={};constructor(h,i){this.#c=h;this.#d=i;this.#e=document.documentElement.lang;document.getElementById('calc-form').addEventListener('submit',async(j)=>{let k=this.#f.strings.message[this.#e];k=k.replace('{selection}',this.#l());k=k.replace('{total}',this.#m());document.querySelector('main form input[name="message"]').value=k;if(this.#m()===0){j.preventDefault();emptySelection();return}if(!document.getElementById('calc-accept').checked){j.preventDefault();if(await confirmTerms()){j.target.submit()}}})}async build(n){this.#f=await this.#o(n);for(const p in this.#f.categories){const q=this.#f.categories[p];const r=document.createElement('section');const s=document.createElement('h2');s.innerText=q.title[this.#e];r.appendChild(s);const t=document.createElement('div');t.classList.add('uk-child-width-1-1','uk-child-width-1-2@s','uk-child-width-1-4@m');t.setAttribute('uk-grid','');r.appendChild(t);q.options.forEach(u=>{const v=document.createElement('article');v.setAttribute('uk-img','');v.setAttribute('data-src',`${this.#f.baseImgPath}${u.img}`);v.addEventListener('click',w=>{this.#g[p]=u;this.#d.innerText=this.#m();Array.from(r.querySelectorAll('article')).forEach(x=>{x.classList.remove('selected')});w.target.classList.add('selected')});const y=document.createElement('h3');y.innerText=u.title[this.#e];v.appendChild(y);const z=document.createElement('span');z.innerHTML=`${u.price} &euro;`;v.appendChild(z);const A=document.createElement('span');A.innerHTML=this.#f.strings.selected[this.#e];A.classList.add('selected-label');v.appendChild(A);const B=document.createElement('div');B.appendChild(v);t.appendChild(B)});this.#c.appendChild(r)}}#m(){let C=0;for(let D in this.#g){const E=this.#g[D];C+=E.price}return C}#l(){let F="";for(let G in this.#g){const H=this.#g[G];if(H.price!==0)F+=`\n- ${this.#f.categories[G].title[this.#e]}: ${H.title[this.#e]} (${H.price}â‚¬)`}return F}async #o(I){I+=`?${Date.now()}`;var J=null;try{J=await(await fetch(I)).json();if(!J){console.error("[calc] malformed data loaded:",J);throw"malformed data"}}catch(K){console.error(`[calc] failed to load ${I}, reason: ${K}`);return}return J}}
